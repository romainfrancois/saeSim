<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Introduction}
-->
```{r include=FALSE}
options(markdown.HTML.header = system.file('misc', 'vignette.css', package='knitr'))
```

# Semi-custom data

Data is generated by combining two aspects. First it must be specified how data adds to the model, then it needs to be specified what data it is. You can use the following functions for that:

- `sim_gen_x(mean, sd, name = "x")`
- `sim_gen_e(mean, sd name = "e")`
- `sim_gen_v(mean, sd, name = "v")`

What data is added can be specified for given generators:

- `gen_norm(mean = 0, sd = 1, name)` - normally distributed variable
- `gen_v_norm(mean = 0, sd = 1, name)` - normally distributed variable but constant within domain
- `gen_v_sar(mean = 0, sd = 1, rho = 0.5, type = "rook", name)` - normally distributed variable following a SAR(1), constant within domain

Meaning we can specify a linear mixed model set-up with the regressor `x`, the model error `e` a random effect `v` and a spatially correlated random effect `vSp` as follows:

```{r}
library(saeSim)
setup <- sim_base() %>% sim_gen_x() %>% sim_gen_e() %>% sim_gen_v() %>% 
  sim_gen(gen_v_sar(name = "vSp")) %>% sim_resp_eq(y = 100 + x + v + vSp + e)
setup
```

To get the simulated data as a list:

```{r eval=FALSE}
dataList <- sim(setup, R = 500)
```

# Contaminated data

When interested in contamination it is important to know, that the contamination adds additively to the values in the data. This means how data is added to the model changes, the data generators stay the same. If you want a contaminated spatially correlated error component you can add the following to the `setup` object from above:

```{r}
contSetup <- setup %>% 
  sim_gen_cont(gen_v_sar(sd = 40, name = "vSp"), nCont = 0.05, type = "area", areaVar = "idD", fixed = TRUE)
```

Note that the generator is the same but with a higher standard deviation. The argument `nCont` controls how much observations are contaminated. Values < 1 are interpreted as probability. A single number as the number of contaminated units (can be areas or observations in each area or observations). When given with `length(nCont) > 1` it will be interpreted as number of contaminated observations in each area. Use the following example to see how these things play together:

```{r}
sim(base_id(3, 4) %>% sim_gen_x() %>% sim_gen_e() %>% 
      sim_gen_ec(mean = 0, sd = 150, name = "eCont", nCont = c(1, 2, 3)))
```
